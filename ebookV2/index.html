<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8">
    <title>PDF Viewer</title>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
        }

        #drawer {
            width: 250px;
            background: #f4f4f4;
            position: fixed;
            top: 0;
            border-radius: 10px;
            bottom: 0;
            margin-top: 50px;
            overflow-y: auto;
            padding: 10px;
            transition: transform 0.3s ease;
            transform: translateX(0);
        }

        #drawer.closed {
            transform: translateX(-260px);
        }

        #drawer .nav-item {
            padding: 8px;
            cursor: pointer;
            border-bottom: 1px solid #ddd;
        }

        #drawer .nav-item:hover {
            background: #ddd;
        }

        #toggleDrawer {
            position: fixed;
            top: 10px;
            left: 10px;
            z-index: 1000;
            background: #007bff;
            color: #fff;
            border: none;
            padding: 8px;
            cursor: pointer;
        }

        #main {
            margin-left: 260px;
            padding: 10px;
            transition: margin-left 0.3s ease;
        }

        #drawer.closed+#main {
            margin-left: 10px;
        }

        #zoom-controls {
            position: fixed;
            right: 20px;
            bottom: 20px;
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid #ccc;
            padding: 10px;
            border-radius: 5px;
            z-index: 1000;
        }

        #zoom-controls button {
            margin: 0 5px;
        }

        canvas {
            border: 1px solid #ccc;
            max-width: 100%;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th,
        td {
            padding: 10px;
            border: 1px solid #ccc;
            text-align: left;
        }

        a {
            color: blue;
            text-decoration: underline;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.14.305/pdf.min.js"></script>
</head>

<body>
    <button id="toggleDrawer" onclick="toggleDrawer()">☰</button>

    <div id="drawer">
        <div class="nav-item" onclick="showHome()">易經 今解</div>
        <div class="nav-item" onclick="showLinks()">連結</div>
        <div class="nav-item" onclick="loadPDF('1.pdf', '1. 華光三部曲')">1. 華光三部曲</div>
        <div class="nav-item" onclick="loadPDF('2.pdf', '2. 孔孟老莊通覽圖')">2. 孔孟老莊通覽圖</div>
        <div class="nav-item" onclick="loadPDF('3.pdf', '3. 孫子兵法幫你贏')">3. 孫子兵法幫你贏</div>
        <div class="nav-item" onclick="loadPDF('4.pdf', '4. 孔孟老莊一本通 + 演講連結')">4. 孔孟老莊一本通 + 演講連結</div>
        <div class="nav-item" onclick="loadPDF('5.pdf', '5. 哈佛學法案例')">5. 哈佛學法案例</div>
        <div class="nav-item" onclick="loadPDF('6.pdf', '6. 決策一條龍')">6. 決策一條龍</div>
        <div class="nav-item" onclick="loadPDF('7.pdf', '7. 心知力解64卦')">7. 心知力解64卦</div>
        <div class="nav-item" onclick="loadPDF('8.pdf', '8. 歌唱易經')">8. 歌唱易經</div>
    </div>

    <!-- 主要內容區 -->
    <div id="main">
        <!-- 頂部工具列（僅於 PDF 顯示時使用） -->
        <div id="toolbar" style="display:none; margin-bottom: 10px;">
            <span id="pdf-title"></span>
            &nbsp;&nbsp;第 <input type="number" id="page-num" value="1" min="1" style="width: 50px;"
                onchange="goToPage()"> 頁 / <span id="page-count">0</span>
        </div>
        <!-- 內容顯示區 -->
        <div id="content">
            <img src="images/professor.jpg" alt="易經 今解" style="max-width:100%;">
        </div>
    </div>

    <!-- 固定右下角的放大縮小控制 -->
    <div id="zoom-controls" style="display:none;">
        <button onclick="zoomOut()">-</button>
        <button onclick="zoomIn()">+</button>
    </div>

    <script>
        let pdfDoc = null,
            currentPage = 1,
            zoomLevel = 1,
            pdfTitle = '';

        // Drawer 開關
        function toggleDrawer() {
            const drawer = document.getElementById('drawer');
            drawer.classList.toggle('closed');
        }

        // 渲染 PDF 頁面
        function renderPage(num) {
            pdfDoc.getPage(num).then(function (page) {
                const viewport = page.getViewport({ scale: zoomLevel });
                const canvas = document.getElementById('pdf-canvas');
                const context = canvas.getContext('2d');
                canvas.height = viewport.height;
                canvas.width = viewport.width;
                page.render({ canvasContext: context, viewport: viewport });
            });
            document.getElementById('page-num').value = num;
        }

        // 加載 PDF 檔案
        function loadPDF(path, title) {
            pdfTitle = title;
            document.getElementById('toolbar').style.display = 'block';
            document.getElementById('zoom-controls').style.display = 'block';
            document.getElementById('pdf-title').textContent = title;
            // 將內容區替換為 canvas 元素
            document.getElementById('content').innerHTML = '<canvas id="pdf-canvas"></canvas>';
            zoomLevel = 1;
            currentPage = 1;
            // 注意：請確保您的伺服器正確提供 assets 目錄下的 PDF 檔案
            pdfjsLib.getDocument(path).promise.then(function (pdf) {
                pdfDoc = pdf;
                document.getElementById('page-count').textContent = pdf.numPages;
                renderPage(currentPage);
            }).catch(err => {
                console.error('PDF 加載錯誤:', err);
                alert('無法讀取 PDF，請檢查檔案路徑與伺服器配置。');
            });
        }

        // 放大縮小功能（更新渲染）
        function zoomIn() {
            if (zoomLevel < 5) {
                zoomLevel += 0.5;
                renderPage(currentPage);
            }
        }
        function zoomOut() {
            if (zoomLevel > 0.5) {
                zoomLevel -= 0.5;
                renderPage(currentPage);
            }
        }

        function goToPage() {
            const desiredPage = parseInt(document.getElementById('page-num').value);
            if (desiredPage >= 1 && desiredPage <= pdfDoc.numPages) {
                currentPage = desiredPage;
                renderPage(currentPage);
            }
        }

        function showHome() {
            document.getElementById('toolbar').style.display = 'none';
            document.getElementById('zoom-controls').style.display = 'none';
            document.getElementById('content').innerHTML = '<img src="professor.jpg" alt="易經 今解" style="max-width:100%;">';
        }

        function showLinks() {
            document.getElementById('toolbar').style.display = 'none';
            document.getElementById('zoom-controls').style.display = 'none';
            const links = [
                { title: 'HBR Ball', url: 'http://140.113.72.120/caseball/examples/caseball.html' },
                { title: '管理學家', url: 'http://140.113.72.120/ManagstBall/examples/gbball.html' },
                { title: '西洋藝術球', url: 'http://140.113.72.120/Artball/Art_ball/gookon/examples/index.html' },
                { title: '電影球', url: 'http://140.113.72.120/MovieBall/examples/movieball.html' },
                { title: '易孔孟老莊', url: 'http://140.113.72.119/gbball/examples/I_Ching.html' },
                { title: '莊子通覽圖網站', url: 'https://connectionouob.github.io/zhuangzi/' },
                { title: '易方陣網站', url: 'https://connectionouob.github.io/YiFangJhen/' }
            ];
            let html = '<table><tr><th>網站標題</th><th>網站連結</th></tr>';
            links.forEach(link => {
                html += `<tr><td>${link.title}</td><td><a href="${link.url}" target="_blank">${link.url}</a></td></tr>`;
            });
            html += '</table>';
            document.getElementById('content').innerHTML = html;
        }
    </script>
</body>

</html>